
<template name="editorForm">
  {{#autoForm id=id collection=collection type=action doc=selected class="toolbar-editor"}}
    
    {{#if formActive}}
      <div class="panel">
        {{> UI.contentBlock this}}
      </div>
    {{/if}}
    
    <div class="toolbar">

      {{#if formActive}}

        {{!-- form toolbar --}}

        {{#if equals mode "add"}}
          <div class="pull-right">
            <button type="button" action="cancel" class="btn btn-small light btn-inverse">Cancel</button>
            <button type="submit" class="btn btn-small btn-primary">Save</button>
          </div>
        {{/if}}

        {{#if equals mode "edit"}}
          <button type="button" action="remove" class="btn btn-small light btn-inverse"><span class="icon icon-white icon-trash"></span></button>
          <div class="pull-right">
            {{> visibilityButton}}
            <button type="button" action="cancel" class="btn btn-small light btn-inverse">Cancel</button>
            <button type="submit" class="btn btn-small btn-primary">Save</button>
          </div>
        {{/if}}

      {{else}}

        {{!-- default toolbar --}}

        {{#if selected}}
          {{#if IsForeignCity selected.city}}
            <div class="text"><span class="icon icon-white icon-globe"></span></div>
          {{/if}}
          {{> visibilityButton}}
        {{/if}}
        <button type="button" class="btn btn-small btn-inverse light {{editActive}}" {{disabled}} action="edit"><span class="icon icon-white icon-pencil"></span> Edit</button>
        <button type="button" class="btn btn-small btn-inverse light" action="add"><span class="icon icon-white icon-plus"></span></button>

      {{/if}}

      <div class="clear"></div>
    </div>

  {{/autoForm}}
</template>



<template name="visibilityButton">
  <div class="btn-group dropup">
    <button type="button" class="btn btn-small btn-inverse light {{visibility.clss}}" {{visibility.attr}}><span class="icon icon-white {{visibility.icon}}"></span> {{visibility.text}}</button>
    <button type="button" class="btn btn-small btn-inverse light dropdown-toggle" data-toggle="dropdown"><span class="caret"></span></button>
    <ul class="dropdown-menu">
      <li><a href="#" action="visibility" toggle="on">Show in {{CurrentCity.name}}</a></li>
      <li><a href="#" action="visibility" toggle="off">Hide in {{CurrentCity.name}}</a></li>
    </ul>
  </div>
</template>
